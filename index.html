<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang chá»§</title>
    <!-- Page.js router -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html-docx-js/dist/html-docx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://unpkg.com/page/page.js"></script>
    <link rel="stylesheet" href="../style/style.css">
    <script src="../data/data.js"></script>
    <script src="../js/script.js"></script>
    <style>
    </style>
</head>
<body>
    <main id="app"></main>
    <script>
        // page('/', () => {
        //     loadPage('html/home.html', 'app').then(() => {
        //         // document.body.setAttribute('data-page', 'login');        
        //         renderProcedures();
        //         renderDossiers();
        //         renderPagination();
                    
        //         document.getElementById('sidebarToggle').onclick = function() {
        //             const sidebar = document.getElementById('sidebar');
        //             sidebar.style.display = (sidebar.style.display === 'block') ? 'none' : 'block';
        //         };
                
        //         window.addEventListener('resize', handleSidebarMobile);
        //         handleSidebarMobile();
        //     });
        // });

        page('/', () => {
            loadPage('html/login.html', 'app').then(() => {
                document.body.setAttribute('data-page', 'login');   
                window.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        login();
                    }
                });
            });
        });

        page('/home', () => {
            loadPage('html/home.html', 'app').then(() => {
                document.body.removeAttribute('data-page');
                initHomeToggleIcons();
                if (wasProcedure) {
                    loadProcedures();
                } else {
                    renderProcedures();
                }
                // renderDossiers();
                // renderPagination();
                 
                let sidebarToggle = document.getElementById('sidebarToggle');
                if (sidebarToggle) {
                    document.getElementById('sidebarToggle').onclick = function() {
                        const sidebar = document.getElementById('sidebar');
                        sidebar.style.display = (sidebar.style.display === 'block') ? 'none' : 'block';
                    };
                }
                
                window.addEventListener('resize', handleSidebarMobile);
                handleSidebarMobile();
            });
        });

        page('/procedure', () => {
            loadPage('html/procedure.html', 'modern-content').then(() => {
                document.body.removeAttribute('data-page');
                loadSteps(selectedIdProcedure, selectedNameProcedure);
                window.addEventListener('resize', () => {
                    loadSteps(selectedIdProcedure, selectedNameProcedure);
                });
            });
        });

        page('/dossier', () => {
            loadPage('html/dossier.html', 'modern-content').then(() => {
                document.body.removeAttribute('data-page');
                const dossierId = sessionStorage.getItem('dossierId');
                if (dossierId) {
                    loadDossierDetail(dossierId);
                }
            });
        });
        
        page({ hashbang: true });
    </script>
</body>
</html>
